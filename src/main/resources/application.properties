# ==============================================
# KnPiano Batch 主配置文件
# 包含所有环境通用的配置
# ==============================================

# Application Configuration
spring.application.name=knpiano-batch

# 设置Web应用类型为none（批处理不需要Web服务器）
# spring.main.web-application-type=none

# 允许bean覆盖
spring.main.allow-bean-definition-overriding=true

# 应用管理配置（用于服务模式）
# 防止应用在没有web容器时立即退出
spring.main.keep-alive=true

# MySQL Database Configuration (通用配置)
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Connection Pool Configuration (通用配置)
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# 引入数据库启动顺序解决方案
spring.profiles.include=db

# MyBatis Configuration (通用配置)
mybatis.config-location=classpath:mybatis/mybatis-config.xml
mybatis.mapper-locations=classpath:mybatis/mapper/*.xml
mybatis.type-aliases-package=com.liu.knbatch.entity

# Spring Batch Configuration (通用配置)
spring.batch.job.enabled=false
spring.batch.jdbc.initialize-schema=always

# 定时任务配置 (通用配置)
spring.task.scheduling.pool.size=2
spring.task.scheduling.thread-name-prefix=knpiano-scheduler-
spring.task.scheduling.shutdown.await-termination=true
spring.task.scheduling.shutdown.await-termination-period=30s

# Jackson时区配置 (通用配置)
spring.jackson.time-zone=GMT+8

# Log Pattern (通用配置)
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%logger{50}] - %msg%n

# Log File Configuration (通用配置)
logging.logback.rollingpolicy.max-file-size=100MB

# ==================== 邮件配置 ====================
# Spring Mail 配置
spring.mail.host=${SPRING_MAIL_HOST}
spring.mail.port=${SPRING_MAIL_PORT}
#切记！切记！！下面的邮箱和密码不要把下面的密码直接提交到GitHub上，应该在群晖Nas上设置环境变量
spring.mail.username=${EMAIL_USERNAME}
spring.mail.password=${EMAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=${SPRING_MAIL_HOST}
# 允许不够安全的应用访问
spring.mail.properties.mail.smtp.ssl.enable=false

# 自定义邮件配置
knbatch.email.enabled=true
knbatch.email.from=${EMAIL_USERNAME}
# 收件人配置 
knbatch.email.to=${EMAIL_RECIPIENTS}
knbatch.email.send-on-success=true
knbatch.email.send-on-failure=true

# Web配置
server.port=8081
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8
spring.main.web-application-type=servlet

#设置国际化语言的基础名（在不指定任何国家语言的情况下，形同采用默认的语言）
spring.messages.basename=i18n.login
#在开发阶段将页面缓存禁止掉（为了修改页面，不受缓存数据搅扰）
spring.thymeleaf.cache=false

# 设置MyBatis的日志级别为DEBUG来打印SQL语句
logging.level.org.apache.ibatis=DEBUG