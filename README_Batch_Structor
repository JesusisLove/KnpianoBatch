# KnpianoBatch é¡¹ç›®ç›®å½•ç»“æ„ (æ›´æ–°ç‰ˆ)

```
KnpianoBatch/                                   # é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ pom.xml                                     # Mavené…ç½®æ–‡ä»¶
â”œâ”€â”€ README.md                                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ .gitignore                                  # Gitå¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ exe/                                        # æ‰§è¡Œè„šæœ¬ç›®å½•
â”‚   â”œâ”€â”€ KNDB1010.sh                            # KNDB1010æ‰¹å¤„ç†æ‰§è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ KNDB1020.sh                            # KNDB1020æ‰¹å¤„ç†æ‰§è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ batch-service-start.sh                # æœåŠ¡æ¨¡å¼å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ batch-service-stop.sh                 # æœåŠ¡æ¨¡å¼åœæ­¢è„šæœ¬
â”‚   â””â”€â”€ logs/                                   # è„šæœ¬æ‰§è¡Œæ—¥å¿—ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ logs/                                       # åº”ç”¨æ—¥å¿—ç›®å½•ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
â”‚   â”œâ”€â”€ knpiano-batch.log                      # ä¸»æ—¥å¿—æ–‡ä»¶
â”‚   â”œâ”€â”€ knpiano-batch-error.log               # é”™è¯¯æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ knpiano-batch-batch.log               # æ‰¹å¤„ç†ä¸“ç”¨æ—¥å¿—
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/com/liu/knbatch/
â”‚   â”‚   â”‚   â”œâ”€â”€ KnpianoBatchApplication.java   # ä¸»åº”ç”¨å¯åŠ¨ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ scheduler/                     # å®šæ—¶ä»»åŠ¡æœåŠ¡åŒ…
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ KNDB1010Scheduled.java    # KNDB1010é’¢ç´è¯¾ç¨‹çº§åˆ«çŸ«æ­£å®šæ—¶ä»»åŠ¡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ KNDB1020Scheduled.java    # KNDB1020å­¦ç”Ÿä¿¡æ¯åŒæ­¥å®šæ—¶ä»»åŠ¡
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ScheduledTaskManagerService.java # å®šæ—¶ä»»åŠ¡ç®¡ç†æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ tasklet/                       # ä¸šåŠ¡å¤„ç†ä»»åŠ¡åŒ…
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ KNDB1010Tasklet.java      # é’¢ç´è¯¾ç¨‹çº§åˆ«çŸ«æ­£ä»»åŠ¡
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ KNDB1020Tasklet.java      # å­¦ç”Ÿä¿¡æ¯åŒæ­¥ä»»åŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ dao/                           # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ KNDB1010Dao.java          # KNDB1010æ•°æ®è®¿é—®æ¥å£
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ KNDB1020Dao.java          # KNDB1020æ•°æ®è®¿é—®æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ entity/                        # å®ä½“ç±»åŒ…
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Lesson.java               # è¯¾ç¨‹å®ä½“ç±»
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Student.java              # å­¦ç”Ÿå®ä½“ç±»ï¼ˆæ–°å¢ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ config/                        # é…ç½®ç±»åŒ…
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BatchConfiguration.java   # ä¸»æ‰¹å¤„ç†é…ç½®ï¼ˆå¯¼å…¥å…¶ä»–é…ç½®ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ KNDB1010Config.java       # KNDB1010ä¸“ç”¨æ‰¹å¤„ç†é…ç½®
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ KNDB1020Config.java       # KNDB1020ä¸“ç”¨æ‰¹å¤„ç†é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ service/                       # ä¸šåŠ¡æœåŠ¡å±‚ï¼ˆå¯é€‰æ‰©å±•ï¼‰
â”‚   â”‚   â”‚       â””â”€â”€ BatchExecutionService.java # æ‰¹å¤„ç†æ‰§è¡ŒæœåŠ¡ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â”œâ”€â”€ application.properties         # ä¸»é…ç½®æ–‡ä»¶
â”‚   â”‚       â”œâ”€â”€ application-dev.properties     # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”‚       â”œâ”€â”€ application-batch.properties   # æ‰¹å¤„ç†ç¯å¢ƒé…ç½®
â”‚   â”‚       â”œâ”€â”€ application-prod.properties    # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚   â”‚       â”œâ”€â”€ logback-spring.xml             # æ—¥å¿—é…ç½®ï¼ˆæ”¯æŒå¤šç¯å¢ƒï¼‰
â”‚   â”‚       â”œâ”€â”€ mybatis/
â”‚   â”‚       â”‚   â”œâ”€â”€ mybatis-config.xml         # MyBatiså…¨å±€é…ç½®
â”‚   â”‚       â”‚   â””â”€â”€ mapper/                    # SQLæ˜ å°„æ–‡ä»¶
â”‚   â”‚       â”‚       â”œâ”€â”€ KNDB1010Mapper.xml    # KNDB1010 SQLæ˜ å°„
â”‚   â”‚       â”‚       â”œâ”€â”€ KNDB1020Mapper.xml    # KNDB1020 SQLæ˜ å°„
â”‚   â”‚       â”‚       â””â”€â”€ ...                   # å…¶ä»–ä¸šåŠ¡æ¨¡å—æ˜ å°„æ–‡ä»¶
â”‚   â”‚       â””â”€â”€ banner.txt                     # Spring Bootå¯åŠ¨æ¨ªå¹…ï¼ˆå¯é€‰ï¼‰
â”‚   â””â”€â”€ test/                                   # æµ‹è¯•ä»£ç 
â”‚       â”œâ”€â”€ java/com/liu/knbatch/
â”‚       â”‚   â”œâ”€â”€ KnpianoBatchApplicationTests.java # ä¸»åº”ç”¨æµ‹è¯•ç±»
â”‚       â”‚   â”œâ”€â”€ scheduler/                     # å®šæ—¶ä»»åŠ¡æµ‹è¯•
â”‚       â”‚   â”‚   â”œâ”€â”€ KNDB1010ScheduledTest.java
â”‚       â”‚   â”‚   â””â”€â”€ KNDB1020ScheduledTest.java
â”‚       â”‚   â”œâ”€â”€ tasklet/                       # ä»»åŠ¡æµ‹è¯•
â”‚       â”‚   â”‚   â”œâ”€â”€ KNDB1010TaskletTest.java
â”‚       â”‚   â”‚   â””â”€â”€ KNDB1020TaskletTest.java
â”‚       â”‚   â””â”€â”€ dao/                           # DAOæµ‹è¯•
â”‚       â”‚       â”œâ”€â”€ KNDB1010DaoTest.java
â”‚       â”‚       â””â”€â”€ KNDB1020DaoTest.java
â”‚       â””â”€â”€ resources/
â”‚           â”œâ”€â”€ application-test.properties    # æµ‹è¯•ç¯å¢ƒé…ç½®
â”‚           â””â”€â”€ test-data/                     # æµ‹è¯•æ•°æ®
â”‚               â”œâ”€â”€ test-lesson-data.sql
â”‚               â””â”€â”€ test-student-data.sql
â”œâ”€â”€ target/                                     # æ„å»ºè¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ classes/                               # ç¼–è¯‘åçš„classæ–‡ä»¶
â”‚   â”œâ”€â”€ knpiano-batch.jar                     # æ‰“åŒ…åçš„å¯æ‰§è¡Œjar
â”‚   â””â”€â”€ logs/                                  # å¼€å‘ç¯å¢ƒè¿è¡Œæ—¥å¿—
â””â”€â”€ docs/                                       # é¡¹ç›®æ–‡æ¡£
    â”œâ”€â”€ DEPLOYMENT.md                          # éƒ¨ç½²è¯´æ˜æ–‡æ¡£
    â”œâ”€â”€ API.md                                 # æ¥å£æ–‡æ¡£ï¼ˆå¦‚æœæœ‰RESTæ¥å£ï¼‰
    â”œâ”€â”€ BATCH_JOBS.md                          # æ‰¹å¤„ç†ä½œä¸šè¯´æ˜æ–‡æ¡£
    â””â”€â”€ TROUBLESHOOTING.md                     # æ•…éšœæ’é™¤æ–‡æ¡£
```

## ä¸»è¦æ›´æ–°è¯´æ˜

### ğŸ†• **æ–°å¢å†…å®¹**
1. **æ¨¡å—åŒ–é…ç½®æ–‡ä»¶**ï¼š
   - `KNDB1010Config.java` - KNDB1010ä¸“ç”¨é…ç½®
   - `KNDB1020Config.java` - KNDB1020ä¸“ç”¨é…ç½®
   - `BatchConfiguration.java` - ä¸»é…ç½®æ–‡ä»¶ï¼ˆå¯¼å…¥å…¶ä»–é…ç½®ï¼‰

2. **å®šæ—¶ä»»åŠ¡åˆ†ç¦»**ï¼š
   - `KNDB1010Scheduled.java` - KNDB1010ä¸“ç”¨å®šæ—¶ä»»åŠ¡
   - `KNDB1020Scheduled.java` - KNDB1020ä¸“ç”¨å®šæ—¶ä»»åŠ¡
   - `ScheduledTaskManagerService.java` - å®šæ—¶ä»»åŠ¡ç®¡ç†

3. **ä¸šåŠ¡æ¨¡å—æ‰©å±•**ï¼š
   - `KNDB1020Tasklet.java` - æ–°çš„ä¸šåŠ¡å¤„ç†ä»»åŠ¡
   - `KNDB1020Dao.java` - æ–°çš„æ•°æ®è®¿é—®æ¥å£
   - `KNDB1020Mapper.xml` - æ–°çš„SQLæ˜ å°„æ–‡ä»¶

4. **æ‰§è¡Œè„šæœ¬å¢å¼º**ï¼š
   - `KNDB1020.sh` - KNDB1020ä¸“ç”¨æ‰§è¡Œè„šæœ¬
   - `batch-service-start.sh` - æœåŠ¡æ¨¡å¼å¯åŠ¨è„šæœ¬
   - `batch-service-stop.sh` - æœåŠ¡æ¨¡å¼åœæ­¢è„šæœ¬

5. **æµ‹è¯•ä½“ç³»**ï¼š
   - å®Œæ•´çš„å•å…ƒæµ‹è¯•ç›®å½•ç»“æ„
   - å„æ¨¡å—çš„ç‹¬ç«‹æµ‹è¯•ç±»

6. **æ–‡æ¡£ä½“ç³»**ï¼š
   - `docs/` ç›®å½•åŒ…å«å„ç§é¡¹ç›®æ–‡æ¡£
   - éƒ¨ç½²ã€æ•…éšœæ’é™¤ç­‰ä¸“é—¨æ–‡æ¡£

### ğŸ“ **é…ç½®æ–‡ä»¶è¯´æ˜**
- **application.properties** - ä¸»é…ç½®
- **application-dev.properties** - å¼€å‘ç¯å¢ƒï¼ˆä½¿ç”¨ç›¸å¯¹è·¯å¾„æ—¥å¿—ï¼‰
- **application-batch.properties** - æ‰‹åŠ¨æ‰¹å¤„ç†ç¯å¢ƒ
- **application-prod.properties** - ç”Ÿäº§ç¯å¢ƒï¼ˆä½¿ç”¨ç»å¯¹è·¯å¾„æ—¥å¿—ï¼‰

### ğŸ¯ **æ¶æ„ç‰¹ç‚¹**
1. **æ¨¡å—åŒ–è®¾è®¡** - æ¯ä¸ªä¸šåŠ¡æ¨¡å—ç‹¬ç«‹é…ç½®å’Œç®¡ç†
2. **ç¯å¢ƒåˆ†ç¦»** - ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„é…ç½®æ–‡ä»¶
3. **èŒè´£æ¸…æ™°** - å®šæ—¶ä»»åŠ¡ã€ä¸šåŠ¡å¤„ç†ã€æ•°æ®è®¿é—®åˆ†å±‚æ˜ç¡®
4. **æ˜“äºæ‰©å±•** - æ·»åŠ æ–°ä¸šåŠ¡æ¨¡å—åªéœ€æŒ‰è§„èŒƒåˆ›å»ºå¯¹åº”æ–‡ä»¶
5. **å®Œæ•´æµ‹è¯•** - åŒ…å«å®Œæ•´çš„æµ‹è¯•ç›®å½•ç»“æ„
6. **æ–‡æ¡£é½å…¨** - åŒ…å«éƒ¨ç½²ã€ä½¿ç”¨ã€æ•…éšœæ’é™¤ç­‰æ–‡æ¡£

è¿™æ ·çš„ç›®å½•ç»“æ„æ›´åŠ ä¸“ä¸šåŒ–å’Œä¼ä¸šçº§ï¼Œä¾¿äºå›¢é˜Ÿåä½œå’Œé¡¹ç›®ç»´æŠ¤ï¼